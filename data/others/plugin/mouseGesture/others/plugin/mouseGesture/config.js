// config画面作成用jsファイルです。
delete gMouseGesture.tmp;
gMouseGesture.tmp = {};
(function (tmp) {
// tmp データの作成
var urlBase='./data/others/plugin/mouseGesture';tmp.select_button_name='right';tmp.select_dir_name='right';tmp.select_obj={};tmp.fadeTime=200;tmp.dir_j={'top':'上フリック','left':'左フリック','right':'右フリック','bottom':'下フリック'};tmp.left_role=gMouseGesture.map[1];tmp.center_role=gMouseGesture.map[2];tmp.right_role=gMouseGesture.map[3];tmp.data={save:{jp:'セーブ',bg:'url('+urlBase+'/config_button.png), #FB241D'},load:{jp:'ロード',bg:'url('+urlBase+'/config_button.png), #349200'},next:{jp:'メッセージ<br />送り',bg:'url('+urlBase+'/config_button.png), #003895'},menu:{jp:'メニュー',bg:'url('+urlBase+'/config_button.png), #FF8800'},config:{jp:'コンフィグ',bg:'url('+urlBase+'/config_button.png), #333'},qsave:{jp:'クイック<br />セーブ',bg:'url('+urlBase+'/config_button.png), #FD5B4C'},qload:{jp:'クイック<br />ロード',bg:'url('+urlBase+'/config_button.png), #74BF00'},skip:{jp:'スキップ',bg:'url('+urlBase+'/config_button.png), #0074BF'},title:{jp:'タイトル<br />に戻る',bg:'url('+urlBase+'/config_button.png), #FFC300'},endgame:{jp:'ゲームを<br />終了する',bg:'url('+urlBase+'/config_button.png), #666'},backlog:{jp:'バックログ',bg:'url('+urlBase+'/config_button.png), #FE9179'},fullscreen:{jp:'フル<br />スクリーン',bg:'url('+urlBase+'/config_button.png), #B9E500'},auto:{jp:'オート',bg:'url('+urlBase+'/config_button.png), #00B9E5'},hidemessage:{jp:'ウィンドウ<br />を隠す',bg:'url('+urlBase+'/config_button.png), #FFE700'},none:{jp:'機能なし',bg:'#BBB'}};tmp.showPalette=function(e){$('.gesture-palette-message').html('<strong>'+tmp.dir_j[tmp.select_dir_name]+'</strong>にセットする機能を選択してください。');$('.gesture-palette').fadeIn(tmp.fadeTime);$('.button_back').fadeOut(tmp.fadeTime)};tmp.hidePalette=function(e){$('.button_back').fadeIn(tmp.fadeTime);$('.gesture-palette').fadeOut(tmp.fadeTime);if(e)e.stopPropagation()};tmp.setCurrentButton=function(button){var role_set;switch(button){case"left":role_set=tmp.left_role;break;case"center":role_set=tmp.center_role;break;case"right":role_set=tmp.right_role;break;default:return false};var i=0;for(var key in role_set){if(key=='nomove')continue;var role=role_set[key];if(role=='')role='none';if(role in tmp.data){$('.gesture-'+key).css('background',tmp.data[role].bg).html('<p>'+tmp.data[role].jp+'</p>')}};tmp.select_button_name=button;$('.gesture_menu').css('background','url("'+urlBase+'/config_'+button+'.png"), url("'+urlBase+'/config_map.png")')};
// 現在のロール設定を画面に反映
tmp.setCurrentButton("right");var button=$('.gesture-button .button');for(var i=0;i<3;i++){button.eq(i).click(function(e){button.removeClass('selected');$(this).addClass('selected');var cName=$(this)[0].className.replace(' selected','');var idx=cName.indexOf('-');var name=cName.substr(idx+1,cName.length-idx-1);tmp.setCurrentButton(name)})};
// 現在の感度設定を画面に反映
var sensitivity=$('.sensitivity');for(var i=0;i<5;i++){sensitivity.eq(i).click(function(e){sensitivity.removeClass('selected');$(this).addClass('selected');var num=$(this)[0].className.replace(/[^0-9]*/g,'');gMouseGesture.set('sensitivity',num);var sf=tyrano.plugin.kag.variable.sf;sf._config_mouse_gesture_sensitivity=num;$.setStorage(tyrano.plugin.kag.config.projectID+'_sf',sf)})};var a=gMouseGesture.sensitivity;$('.sensitivity-'+a).addClass('selected');
// ロールパレットの作成
var top=100;var left=70;var margin_top=10;var margin_left=10;var size=160;var column=5;var i=0;for(var key in tmp.data){$(''+'<div class="gesture-palette-item '+key+'" style="'+'top :'+(top+(margin_top+size)*((i/column)|0))+'px;'+'left:'+(left+(margin_left+size)*((i%column)|0))+'px;'+'background:'+tmp.data[key].bg+';'+'"><p>'+tmp.data[key].jp+'</p></div>').appendTo('.gesture-palette').click(function(){tmp.hidePalette();var role_name=$(this)[0].className.replace('gesture-palette-item ','');tmp.select_obj.css('background',tmp.data[role_name].bg).html($(this).html());gMouseGesture.set(tmp.select_button_name,tmp.select_dir_name,role_name);var sf=tyrano.plugin.kag.variable.sf;sf._config_mouse_gesture_left_map=gMouseGesture.map[1];sf._config_mouse_gesture_center_map=gMouseGesture.map[2];sf._config_mouse_gesture_right_map=gMouseGesture.map[3];$.setStorage(tyrano.plugin.kag.config.projectID+"_sf",sf)});i++;continue};
// クリックイベントの登録
$('.gesture-top').click(function(){tmp.select_dir_name='top';tmp.select_obj=$(this);tmp.showPalette()});$('.gesture-left').click(function(){tmp.select_dir_name='left';tmp.select_obj=$(this);tmp.showPalette()});$('.gesture-right').click(function(){tmp.select_dir_name='right';tmp.select_obj=$(this);tmp.showPalette()});$('.gesture-bottom').click(function(){tmp.select_dir_name='bottom';tmp.select_obj=$(this);tmp.showPalette()});$('.gesture-palette-cover').click(tmp.hidePalette).bind('contextmenu',tmp.hidePalette);$('.gesture-palette-item').bind('contextmenu',tmp.hidePalette);$('.gesture-palette-item').click(function(e){e.stopPropagation()});
}(gMouseGesture.tmp));